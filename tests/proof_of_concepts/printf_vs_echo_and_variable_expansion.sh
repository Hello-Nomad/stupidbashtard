#!/bin/bash

function run_test {
  local i=1
  local var_string=''
  local tool="$1"
  local EXPANSIONS=$2
  local START="$(date +'%s%N')"

  case "${EXPANSIONS}" in
    0     ) while [ ${i} -le ${ITERATIONS} ] ; do ${tool} 'text' >/dev/null ; let i++ ; done   ;;
    10    ) while [ ${i} -le ${ITERATIONS} ] ; do ${tool} "${TEXT1}${TEXT2}${TEXT3}${TEXT4}${TEXT5}${TEXT6}${TEXT7}${TEXT8}${TEXT9}${TEXT10}" >/dev/null ; let i++ ; done   ;;
    100   ) while [ ${i} -le ${ITERATIONS} ] ; do ${tool} "${TEXT1}${TEXT2}${TEXT3}${TEXT4}${TEXT5}${TEXT6}${TEXT7}${TEXT8}${TEXT9}${TEXT10}${TEXT11}${TEXT12}${TEXT13}${TEXT14}${TEXT15}${TEXT16}${TEXT17}${TEXT18}${TEXT19}${TEXT20}${TEXT21}${TEXT22}${TEXT23}${TEXT24}${TEXT25}${TEXT26}${TEXT27}${TEXT28}${TEXT29}${TEXT30}${TEXT31}${TEXT32}${TEXT33}${TEXT34}${TEXT35}${TEXT36}${TEXT37}${TEXT38}${TEXT39}${TEXT40}${TEXT41}${TEXT42}${TEXT43}${TEXT44}${TEXT45}${TEXT46}${TEXT47}${TEXT48}${TEXT49}${TEXT50}${TEXT51}${TEXT52}${TEXT53}${TEXT54}${TEXT55}${TEXT56}${TEXT57}${TEXT58}${TEXT59}${TEXT60}${TEXT61}${TEXT62}${TEXT63}${TEXT64}${TEXT65}${TEXT66}${TEXT67}${TEXT68}${TEXT69}${TEXT70}${TEXT71}${TEXT72}${TEXT73}${TEXT74}${TEXT75}${TEXT76}${TEXT77}${TEXT78}${TEXT79}${TEXT80}${TEXT81}${TEXT82}${TEXT83}${TEXT84}${TEXT85}${TEXT86}${TEXT87}${TEXT88}${TEXT89}${TEXT90}${TEXT91}${TEXT92}${TEXT93}${TEXT94}${TEXT95}${TEXT96}${TEXT97}${TEXT98}${TEXT99}${TEXT100}" >/dev/null ; let i++ ; done   ;;
    1000  ) while [ ${i} -le ${ITERATIONS} ] ; do ${tool} "${TEXT1}${TEXT2}${TEXT3}${TEXT4}${TEXT5}${TEXT6}${TEXT7}${TEXT8}${TEXT9}${TEXT10}${TEXT11}${TEXT12}${TEXT13}${TEXT14}${TEXT15}${TEXT16}${TEXT17}${TEXT18}${TEXT19}${TEXT20}${TEXT21}${TEXT22}${TEXT23}${TEXT24}${TEXT25}${TEXT26}${TEXT27}${TEXT28}${TEXT29}${TEXT30}${TEXT31}${TEXT32}${TEXT33}${TEXT34}${TEXT35}${TEXT36}${TEXT37}${TEXT38}${TEXT39}${TEXT40}${TEXT41}${TEXT42}${TEXT43}${TEXT44}${TEXT45}${TEXT46}${TEXT47}${TEXT48}${TEXT49}${TEXT50}${TEXT51}${TEXT52}${TEXT53}${TEXT54}${TEXT55}${TEXT56}${TEXT57}${TEXT58}${TEXT59}${TEXT60}${TEXT61}${TEXT62}${TEXT63}${TEXT64}${TEXT65}${TEXT66}${TEXT67}${TEXT68}${TEXT69}${TEXT70}${TEXT71}${TEXT72}${TEXT73}${TEXT74}${TEXT75}${TEXT76}${TEXT77}${TEXT78}${TEXT79}${TEXT80}${TEXT81}${TEXT82}${TEXT83}${TEXT84}${TEXT85}${TEXT86}${TEXT87}${TEXT88}${TEXT89}${TEXT90}${TEXT91}${TEXT92}${TEXT93}${TEXT94}${TEXT95}${TEXT96}${TEXT97}${TEXT98}${TEXT99}${TEXT100}${TEXT101}${TEXT102}${TEXT103}${TEXT104}${TEXT105}${TEXT106}${TEXT107}${TEXT108}${TEXT109}${TEXT110}${TEXT111}${TEXT112}${TEXT113}${TEXT114}${TEXT115}${TEXT116}${TEXT117}${TEXT118}${TEXT119}${TEXT120}${TEXT121}${TEXT122}${TEXT123}${TEXT124}${TEXT125}${TEXT126}${TEXT127}${TEXT128}${TEXT129}${TEXT130}${TEXT131}${TEXT132}${TEXT133}${TEXT134}${TEXT135}${TEXT136}${TEXT137}${TEXT138}${TEXT139}${TEXT140}${TEXT141}${TEXT142}${TEXT143}${TEXT144}${TEXT145}${TEXT146}${TEXT147}${TEXT148}${TEXT149}${TEXT150}${TEXT151}${TEXT152}${TEXT153}${TEXT154}${TEXT155}${TEXT156}${TEXT157}${TEXT158}${TEXT159}${TEXT160}${TEXT161}${TEXT162}${TEXT163}${TEXT164}${TEXT165}${TEXT166}${TEXT167}${TEXT168}${TEXT169}${TEXT170}${TEXT171}${TEXT172}${TEXT173}${TEXT174}${TEXT175}${TEXT176}${TEXT177}${TEXT178}${TEXT179}${TEXT180}${TEXT181}${TEXT182}${TEXT183}${TEXT184}${TEXT185}${TEXT186}${TEXT187}${TEXT188}${TEXT189}${TEXT190}${TEXT191}${TEXT192}${TEXT193}${TEXT194}${TEXT195}${TEXT196}${TEXT197}${TEXT198}${TEXT199}${TEXT200}${TEXT201}${TEXT202}${TEXT203}${TEXT204}${TEXT205}${TEXT206}${TEXT207}${TEXT208}${TEXT209}${TEXT210}${TEXT211}${TEXT212}${TEXT213}${TEXT214}${TEXT215}${TEXT216}${TEXT217}${TEXT218}${TEXT219}${TEXT220}${TEXT221}${TEXT222}${TEXT223}${TEXT224}${TEXT225}${TEXT226}${TEXT227}${TEXT228}${TEXT229}${TEXT230}${TEXT231}${TEXT232}${TEXT233}${TEXT234}${TEXT235}${TEXT236}${TEXT237}${TEXT238}${TEXT239}${TEXT240}${TEXT241}${TEXT242}${TEXT243}${TEXT244}${TEXT245}${TEXT246}${TEXT247}${TEXT248}${TEXT249}${TEXT250}${TEXT251}${TEXT252}${TEXT253}${TEXT254}${TEXT255}${TEXT256}${TEXT257}${TEXT258}${TEXT259}${TEXT260}${TEXT261}${TEXT262}${TEXT263}${TEXT264}${TEXT265}${TEXT266}${TEXT267}${TEXT268}${TEXT269}${TEXT270}${TEXT271}${TEXT272}${TEXT273}${TEXT274}${TEXT275}${TEXT276}${TEXT277}${TEXT278}${TEXT279}${TEXT280}${TEXT281}${TEXT282}${TEXT283}${TEXT284}${TEXT285}${TEXT286}${TEXT287}${TEXT288}${TEXT289}${TEXT290}${TEXT291}${TEXT292}${TEXT293}${TEXT294}${TEXT295}${TEXT296}${TEXT297}${TEXT298}${TEXT299}${TEXT300}${TEXT301}${TEXT302}${TEXT303}${TEXT304}${TEXT305}${TEXT306}${TEXT307}${TEXT308}${TEXT309}${TEXT310}${TEXT311}${TEXT312}${TEXT313}${TEXT314}${TEXT315}${TEXT316}${TEXT317}${TEXT318}${TEXT319}${TEXT320}${TEXT321}${TEXT322}${TEXT323}${TEXT324}${TEXT325}${TEXT326}${TEXT327}${TEXT328}${TEXT329}${TEXT330}${TEXT331}${TEXT332}${TEXT333}${TEXT334}${TEXT335}${TEXT336}${TEXT337}${TEXT338}${TEXT339}${TEXT340}${TEXT341}${TEXT342}${TEXT343}${TEXT344}${TEXT345}${TEXT346}${TEXT347}${TEXT348}${TEXT349}${TEXT350}${TEXT351}${TEXT352}${TEXT353}${TEXT354}${TEXT355}${TEXT356}${TEXT357}${TEXT358}${TEXT359}${TEXT360}${TEXT361}${TEXT362}${TEXT363}${TEXT364}${TEXT365}${TEXT366}${TEXT367}${TEXT368}${TEXT369}${TEXT370}${TEXT371}${TEXT372}${TEXT373}${TEXT374}${TEXT375}${TEXT376}${TEXT377}${TEXT378}${TEXT379}${TEXT380}${TEXT381}${TEXT382}${TEXT383}${TEXT384}${TEXT385}${TEXT386}${TEXT387}${TEXT388}${TEXT389}${TEXT390}${TEXT391}${TEXT392}${TEXT393}${TEXT394}${TEXT395}${TEXT396}${TEXT397}${TEXT398}${TEXT399}${TEXT400}${TEXT401}${TEXT402}${TEXT403}${TEXT404}${TEXT405}${TEXT406}${TEXT407}${TEXT408}${TEXT409}${TEXT410}${TEXT411}${TEXT412}${TEXT413}${TEXT414}${TEXT415}${TEXT416}${TEXT417}${TEXT418}${TEXT419}${TEXT420}${TEXT421}${TEXT422}${TEXT423}${TEXT424}${TEXT425}${TEXT426}${TEXT427}${TEXT428}${TEXT429}${TEXT430}${TEXT431}${TEXT432}${TEXT433}${TEXT434}${TEXT435}${TEXT436}${TEXT437}${TEXT438}${TEXT439}${TEXT440}${TEXT441}${TEXT442}${TEXT443}${TEXT444}${TEXT445}${TEXT446}${TEXT447}${TEXT448}${TEXT449}${TEXT450}${TEXT451}${TEXT452}${TEXT453}${TEXT454}${TEXT455}${TEXT456}${TEXT457}${TEXT458}${TEXT459}${TEXT460}${TEXT461}${TEXT462}${TEXT463}${TEXT464}${TEXT465}${TEXT466}${TEXT467}${TEXT468}${TEXT469}${TEXT470}${TEXT471}${TEXT472}${TEXT473}${TEXT474}${TEXT475}${TEXT476}${TEXT477}${TEXT478}${TEXT479}${TEXT480}${TEXT481}${TEXT482}${TEXT483}${TEXT484}${TEXT485}${TEXT486}${TEXT487}${TEXT488}${TEXT489}${TEXT490}${TEXT491}${TEXT492}${TEXT493}${TEXT494}${TEXT495}${TEXT496}${TEXT497}${TEXT498}${TEXT499}${TEXT500}${TEXT501}${TEXT502}${TEXT503}${TEXT504}${TEXT505}${TEXT506}${TEXT507}${TEXT508}${TEXT509}${TEXT510}${TEXT511}${TEXT512}${TEXT513}${TEXT514}${TEXT515}${TEXT516}${TEXT517}${TEXT518}${TEXT519}${TEXT520}${TEXT521}${TEXT522}${TEXT523}${TEXT524}${TEXT525}${TEXT526}${TEXT527}${TEXT528}${TEXT529}${TEXT530}${TEXT531}${TEXT532}${TEXT533}${TEXT534}${TEXT535}${TEXT536}${TEXT537}${TEXT538}${TEXT539}${TEXT540}${TEXT541}${TEXT542}${TEXT543}${TEXT544}${TEXT545}${TEXT546}${TEXT547}${TEXT548}${TEXT549}${TEXT550}${TEXT551}${TEXT552}${TEXT553}${TEXT554}${TEXT555}${TEXT556}${TEXT557}${TEXT558}${TEXT559}${TEXT560}${TEXT561}${TEXT562}${TEXT563}${TEXT564}${TEXT565}${TEXT566}${TEXT567}${TEXT568}${TEXT569}${TEXT570}${TEXT571}${TEXT572}${TEXT573}${TEXT574}${TEXT575}${TEXT576}${TEXT577}${TEXT578}${TEXT579}${TEXT580}${TEXT581}${TEXT582}${TEXT583}${TEXT584}${TEXT585}${TEXT586}${TEXT587}${TEXT588}${TEXT589}${TEXT590}${TEXT591}${TEXT592}${TEXT593}${TEXT594}${TEXT595}${TEXT596}${TEXT597}${TEXT598}${TEXT599}${TEXT600}${TEXT601}${TEXT602}${TEXT603}${TEXT604}${TEXT605}${TEXT606}${TEXT607}${TEXT608}${TEXT609}${TEXT610}${TEXT611}${TEXT612}${TEXT613}${TEXT614}${TEXT615}${TEXT616}${TEXT617}${TEXT618}${TEXT619}${TEXT620}${TEXT621}${TEXT622}${TEXT623}${TEXT624}${TEXT625}${TEXT626}${TEXT627}${TEXT628}${TEXT629}${TEXT630}${TEXT631}${TEXT632}${TEXT633}${TEXT634}${TEXT635}${TEXT636}${TEXT637}${TEXT638}${TEXT639}${TEXT640}${TEXT641}${TEXT642}${TEXT643}${TEXT644}${TEXT645}${TEXT646}${TEXT647}${TEXT648}${TEXT649}${TEXT650}${TEXT651}${TEXT652}${TEXT653}${TEXT654}${TEXT655}${TEXT656}${TEXT657}${TEXT658}${TEXT659}${TEXT660}${TEXT661}${TEXT662}${TEXT663}${TEXT664}${TEXT665}${TEXT666}${TEXT667}${TEXT668}${TEXT669}${TEXT670}${TEXT671}${TEXT672}${TEXT673}${TEXT674}${TEXT675}${TEXT676}${TEXT677}${TEXT678}${TEXT679}${TEXT680}${TEXT681}${TEXT682}${TEXT683}${TEXT684}${TEXT685}${TEXT686}${TEXT687}${TEXT688}${TEXT689}${TEXT690}${TEXT691}${TEXT692}${TEXT693}${TEXT694}${TEXT695}${TEXT696}${TEXT697}${TEXT698}${TEXT699}${TEXT700}${TEXT701}${TEXT702}${TEXT703}${TEXT704}${TEXT705}${TEXT706}${TEXT707}${TEXT708}${TEXT709}${TEXT710}${TEXT711}${TEXT712}${TEXT713}${TEXT714}${TEXT715}${TEXT716}${TEXT717}${TEXT718}${TEXT719}${TEXT720}${TEXT721}${TEXT722}${TEXT723}${TEXT724}${TEXT725}${TEXT726}${TEXT727}${TEXT728}${TEXT729}${TEXT730}${TEXT731}${TEXT732}${TEXT733}${TEXT734}${TEXT735}${TEXT736}${TEXT737}${TEXT738}${TEXT739}${TEXT740}${TEXT741}${TEXT742}${TEXT743}${TEXT744}${TEXT745}${TEXT746}${TEXT747}${TEXT748}${TEXT749}${TEXT750}${TEXT751}${TEXT752}${TEXT753}${TEXT754}${TEXT755}${TEXT756}${TEXT757}${TEXT758}${TEXT759}${TEXT760}${TEXT761}${TEXT762}${TEXT763}${TEXT764}${TEXT765}${TEXT766}${TEXT767}${TEXT768}${TEXT769}${TEXT770}${TEXT771}${TEXT772}${TEXT773}${TEXT774}${TEXT775}${TEXT776}${TEXT777}${TEXT778}${TEXT779}${TEXT780}${TEXT781}${TEXT782}${TEXT783}${TEXT784}${TEXT785}${TEXT786}${TEXT787}${TEXT788}${TEXT789}${TEXT790}${TEXT791}${TEXT792}${TEXT793}${TEXT794}${TEXT795}${TEXT796}${TEXT797}${TEXT798}${TEXT799}${TEXT800}${TEXT801}${TEXT802}${TEXT803}${TEXT804}${TEXT805}${TEXT806}${TEXT807}${TEXT808}${TEXT809}${TEXT810}${TEXT811}${TEXT812}${TEXT813}${TEXT814}${TEXT815}${TEXT816}${TEXT817}${TEXT818}${TEXT819}${TEXT820}${TEXT821}${TEXT822}${TEXT823}${TEXT824}${TEXT825}${TEXT826}${TEXT827}${TEXT828}${TEXT829}${TEXT830}${TEXT831}${TEXT832}${TEXT833}${TEXT834}${TEXT835}${TEXT836}${TEXT837}${TEXT838}${TEXT839}${TEXT840}${TEXT841}${TEXT842}${TEXT843}${TEXT844}${TEXT845}${TEXT846}${TEXT847}${TEXT848}${TEXT849}${TEXT850}${TEXT851}${TEXT852}${TEXT853}${TEXT854}${TEXT855}${TEXT856}${TEXT857}${TEXT858}${TEXT859}${TEXT860}${TEXT861}${TEXT862}${TEXT863}${TEXT864}${TEXT865}${TEXT866}${TEXT867}${TEXT868}${TEXT869}${TEXT870}${TEXT871}${TEXT872}${TEXT873}${TEXT874}${TEXT875}${TEXT876}${TEXT877}${TEXT878}${TEXT879}${TEXT880}${TEXT881}${TEXT882}${TEXT883}${TEXT884}${TEXT885}${TEXT886}${TEXT887}${TEXT888}${TEXT889}${TEXT890}${TEXT891}${TEXT892}${TEXT893}${TEXT894}${TEXT895}${TEXT896}${TEXT897}${TEXT898}${TEXT899}${TEXT900}${TEXT901}${TEXT902}${TEXT903}${TEXT904}${TEXT905}${TEXT906}${TEXT907}${TEXT908}${TEXT909}${TEXT910}${TEXT911}${TEXT912}${TEXT913}${TEXT914}${TEXT915}${TEXT916}${TEXT917}${TEXT918}${TEXT919}${TEXT920}${TEXT921}${TEXT922}${TEXT923}${TEXT924}${TEXT925}${TEXT926}${TEXT927}${TEXT928}${TEXT929}${TEXT930}${TEXT931}${TEXT932}${TEXT933}${TEXT934}${TEXT935}${TEXT936}${TEXT937}${TEXT938}${TEXT939}${TEXT940}${TEXT941}${TEXT942}${TEXT943}${TEXT944}${TEXT945}${TEXT946}${TEXT947}${TEXT948}${TEXT949}${TEXT950}${TEXT951}${TEXT952}${TEXT953}${TEXT954}${TEXT955}${TEXT956}${TEXT957}${TEXT958}${TEXT959}${TEXT960}${TEXT961}${TEXT962}${TEXT963}${TEXT964}${TEXT965}${TEXT966}${TEXT967}${TEXT968}${TEXT969}${TEXT970}${TEXT971}${TEXT972}${TEXT973}${TEXT974}${TEXT975}${TEXT976}${TEXT977}${TEXT978}${TEXT979}${TEXT980}${TEXT981}${TEXT982}${TEXT983}${TEXT984}${TEXT985}${TEXT986}${TEXT987}${TEXT988}${TEXT989}${TEXT990}${TEXT991}${TEXT992}${TEXT993}${TEXT994}${TEXT995}${TEXT996}${TEXT997}${TEXT998}${TEXT999}${TEXT1000}" >/dev/null ; let i++ ; done   ;;
    *     ) echo "Unknown expansions value: ${EXPANSIONS}.  Leaving." ; exit 1 ;;
  esac
  local END="$(date +'%s%N')"
  local TIME="$(( ${END} - ${START} ))"
  echo "$(( ${TIME} / 1000000 ))"
  return 0
}


################
#  Main Logic  #
################
# -- Setup text vars
i=1
echo -n 'Setting up TEXT variables for future expansion... '
while [ ${i} -le 1000 ] ; do
  eval "TEXT${i}='text'"
  let i++
done
echo 'done!'


# Print a header and get ready to rock and roll
echo '+------------+-----------------+-----------------+-----------------+-----------------+'
echo '| Iterations |    0 Expansions |   10 Expansions |  100 Expansions | 1000 Expansions |'

# -- Loop through iterations
for ITERATIONS in 1 10 100 1000 10000 ; do
  # Separate iterations into groups with a row separator.
  echo '+------------+-----------------+-----------------+-----------------+-----------------+'
  printf '|%11s |%s\n'  ${ITERATIONS} '  echo :  printf |  echo :  printf |  echo :  printf |  echo :  printf |'

  # -- Field 1:  Blank
  printf '|%11s |' ''

  # -- Fields 2-5:  Expansions
  for exp in 0 10 100 1000 ; do
    printf '%6s ' "$(run_test 'echo' ${exp})"
    printf '   %6s |' "$(run_test 'printf' ${exp})"
  done
echo
done
echo '+------------+-----------------+-----------------+-----------------+-----------------+'

